<?xml version="1.0"?>
<!--
  ~ Dhl Shipping
  ~
  ~ DISCLAIMER
  ~
  ~ Do not edit or add to this file if you wish to upgrade this extension to
  ~ newer versions in the future.
  ~
  ~  PHP version 5.6+
  ~
  ~  @category  Dhlparcel
  ~  @author    Shin Ho <plugins@dhl.com>
  ~  @author    Rudger Gravenstein <plugins@dhl.com>
  ~  @author    Ron Oerlemans <plugins@dhl.com>
  ~  @copyright ${YEAR} DHLParcel
  ~  @link      https://www.dhlparcel.nl/
  -->

<config>
    <modules>
        <DHLParcel_Shipping>
            <version>1.1.9</version>
        </DHLParcel_Shipping>
    </modules>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <DHLParcel_Shipping before="Mage_Adminhtml">DHLParcel_Shipping_Adminhtml</DHLParcel_Shipping>
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin>
    <global>
        <blocks>
            <dhlparcel_shipping>
                <class>DHLParcel_Shipping_Block</class>
            </dhlparcel_shipping>
            <adminhtml>
                <rewrite>
                    <sales_order_shipment_view_form>DHLParcel_Shipping_Block_Adminhtml_Sales_Order_Shipment_View_Form</sales_order_shipment_view_form>
                </rewrite>
            </adminhtml>
        </blocks>
        <models>
            <dhlparcel_shipping>
                <class>DHLParcel_Shipping_Model</class>
                <resourceModel>dhlparcel_shipping_resource</resourceModel>
            </dhlparcel_shipping>
            <dhlparcel_shipping_resource>
                <class>DHLParcel_Shipping_Model_Resource</class>
                <entities>
                    <matrixrate>
                        <table>dhlparcel_shipping_matrixrate</table>
                    </matrixrate>
                    <matrixrateps>
                        <table>dhlparcel_shipping_matrixrateps</table>
                    </matrixrateps>
                    <piece>
                        <table>dhlparcel_shipping_piece</table>
                    </piece>
                </entities>
            </dhlparcel_shipping_resource>
        </models>
        <sales>
            <shipping>
                <carriers>
                    <dhlparcel>DHLParcel_Shipping_Model_Carrier</dhlparcel>
                </carriers>
            </shipping>
            <quote>
                <totals>
                    <shipping>
                        <class>dhlparcel_shipping/quote_address_total_shipping</class>
                    </shipping>
                </totals>
            </quote>
        </sales>
        <helpers>
            <dhlparcel_shipping>
                <class>DHLParcel_Shipping_Helper</class>
            </dhlparcel_shipping>
        </helpers>
        <events>
            <sales_order_resource_init_virtual_grid_columns>
                <observers>
                    <dhlparcel_sales_order_grid>
                        <model>dhlparcel_shipping/adminhtml_grid_salesgrid</model>
                        <method>addColumnToResource</method>
                    </dhlparcel_sales_order_grid>
                </observers>
            </sales_order_resource_init_virtual_grid_columns>
            <admin_system_config_changed_section_carriers>
                <observers>
                    <dhlparcel_config_contradiction_check>
                        <type>singleton</type>
                        <class>dhlparcel_shipping/observer</class>
                        <method>checkConfigContradictions</method>
                    </dhlparcel_config_contradiction_check>
                </observers>
            </admin_system_config_changed_section_carriers>
        </events>
        <cache>
            <types>
                <dhlparcel_shipping translate="label,description" module="dhlparcel_shipping">
                    <label>DHLParcel</label>
                    <description>Caching API calls</description>
                    <tags>dhlparcel_shipping</tags>
                </dhlparcel_shipping>
            </types>
        </cache>
        <resources>
            <dhlparcel_shipping_setup>
                <setup>
                    <module>DHLParcel_Shipping</module>
                    <class>Mage_Sales_Model_Resource_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </dhlparcel_shipping_setup>

            <dhlparcel_shipping_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </dhlparcel_shipping_write>

            <dhlparcel_shipping_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </dhlparcel_shipping_read>
        </resources>

        <fieldsets>
            <sales_convert_quote>
                <dhlparcel_servicepoint>
                    <to_order>*</to_order>
                </dhlparcel_servicepoint>
                <dhlparcel_shipping_options>
                    <to_order>*</to_order>
                </dhlparcel_shipping_options>
                <dhlparcel_shipping_date>
                    <to_order>*</to_order>
                </dhlparcel_shipping_date>
            </sales_convert_quote>
            <sales_convert_order>
                <dhlparcel_servicepoint>
                    <to_quote>*</to_quote>
                </dhlparcel_servicepoint>
                <dhlparcel_shipping_options>
                    <to_quote>*</to_quote>
                </dhlparcel_shipping_options>
                <dhlparcel_shipping_date>
                    <to_order>*</to_order>
                </dhlparcel_shipping_date>
            </sales_convert_order>
        </fieldsets>
    </global>
    <frontend>
        <translate>
            <modules>
                <DHLParcel_Shipping>
                    <files>
                        <default>DHLParcel_Shipping.csv</default>
                    </files>
                </DHLParcel_Shipping>
            </modules>
        </translate>
        <routers>
            <dhlparcel_shipping>
                <use>standard</use>
                <args>
                    <module>DHLParcel_Shipping</module>
                    <frontName>dhlparcel_shipping</frontName>
                </args>
            </dhlparcel_shipping>
        </routers>
        <layout>
            <updates>
                <dhlparcel_shipping>
                    <file>dhlparcel_shipping.xml</file>
                </dhlparcel_shipping>
            </updates>
        </layout>
        <events>
            <checkout_controller_onepage_save_shipping_method>
                <observers>
                    <dhlparcel_shipping_model_checkout_observer>
                        <class>dhlparcel_shipping/checkout_observer</class>
                        <method>saveShippingMethod</method>
                    </dhlparcel_shipping_model_checkout_observer>
                </observers>
            </checkout_controller_onepage_save_shipping_method>
            <controller_action_predispatch_checkout_onepage_index>
                <observers>
                    <dhlparcel_shipping_controller_action_predispatch_checkout_onepage_index>
                        <class>dhlparcel_shipping/checkout_observer</class>
                        <method>preDispatchCheckout</method>
                    </dhlparcel_shipping_controller_action_predispatch_checkout_onepage_index>
                </observers>
            </controller_action_predispatch_checkout_onepage_index>
            <controller_action_predispatch_onestepcheckout_index_index>
                <observers>
                    <dhlparcel_shipping_controller_action_predispatch_onestepcheckout_index_index>
                        <class>dhlparcel_shipping/checkout_observer</class>
                        <method>preDispatchCheckout</method>
                    </dhlparcel_shipping_controller_action_predispatch_onestepcheckout_index_index>
                </observers>
            </controller_action_predispatch_onestepcheckout_index_index>
            <sales_quote_address_collect_totals_after>
                <observers>
                    <dhlparcel_shipping_observer_servicepoint_description>
                        <class>dhlparcel_shipping/observers_servicePointDescription</class>
                        <method>update</method>
                    </dhlparcel_shipping_observer_servicepoint_description>
                </observers>
            </sales_quote_address_collect_totals_after>
        </events>
    </frontend>
    <adminhtml>
        <translate>
            <modules>
                <DHLParcel_Shipping>
                    <files>
                        <default>DHLParcel_Shipping.csv</default>
                    </files>
                </DHLParcel_Shipping>
            </modules>
        </translate>
        <layout>
            <updates>
                <dhlparcel_shipping_adminhtml>
                    <file>dhlparcel/shipping.xml</file>
                </dhlparcel_shipping_adminhtml>
            </updates>
        </layout>
        <events>
            <controller_action_postdispatch_adminhtml_sales_order_shipment_save>
                <observers>
                    <dhl_create_label_on_save>
                        <class>dhlparcel_shipping/adminhtml_observer</class>
                        <method>saveShipment</method>
                    </dhl_create_label_on_save>
                </observers>
            </controller_action_postdispatch_adminhtml_sales_order_shipment_save>
            <sales_order_shipment_save_before>
                <observers>
                    <dhlparcel_shipping_sales_order_shipment_save_before>
                        <type>singleton</type>
                        <class>dhlparcel_shipping/adminhtml_observer</class>
                        <method>salesOrderShipmentSaveBefore</method>
                    </dhlparcel_shipping_sales_order_shipment_save_before>
                </observers>
            </sales_order_shipment_save_before>
            <sales_order_shipment_save_after>
                <observers>
                    <dhlparcel_shipping_sales_order_shipment_save_after>
                        <type>singleton</type>
                        <class>dhlparcel_shipping/adminhtml_observer</class>
                        <method>salesOrderShipmentSaveAfter</method>
                    </dhlparcel_shipping_sales_order_shipment_save_after>
                </observers>
            </sales_order_shipment_save_after>
            <core_block_abstract_prepare_layout_after>
                <observers>
                    <dhlparcel_shipping_core_block_abstract_prepare_layout_after>
                        <class>dhlparcel_shipping/adminhtml_observer</class>
                        <method>addMassActions</method>
                    </dhlparcel_shipping_core_block_abstract_prepare_layout_after>
                </observers>
            </core_block_abstract_prepare_layout_after>
        </events>
    </adminhtml>
    <default>
        <carriers>
            <dhlparcel>
                <active>0</active>
                <sort_order>10</sort_order>
                <model>dhlparcel_shipping/carrier</model>
                <title>DHLParcel</title>
                <b2b>0</b2b>
                <sort_order>10</sort_order>
                <sallowspecific>0</sallowspecific>
                <gateway_url>https://api-gw.dhlparcel.nl/</gateway_url>
                <api_user/>
                <api_key/>
                <api_account_id/>
                <to_business>0</to_business>
                <parcelshop_limit>20</parcelshop_limit>
                <sender_type>business</sender_type>
                <specificerrmsg>This shipping method is currently unavailable. If you would like to ship using this shipping method, please contact us.</specificerrmsg>
                <track_trace_url><![CDATA[https://www.dhlparcel.nl/nl/volg-uw-zending?tc={{tracknumber}}&pc={{postalcode}}]]></track_trace_url>
                <debug>0</debug>
                <save_label_requests>0</save_label_requests>
                <load_jquery>0</load_jquery>
            </dhlparcel>
            <dhlparcel_labels>
                <label_print_ordernumer>1</label_print_ordernumer>
                <label_reference_field>order_increment_id</label_reference_field>
                <label_reference2_text>Order</label_reference2_text>
            </dhlparcel_labels>
            <DOOR_dhlparcel>
                <active>0</active>
                <title>Homedelivery</title>
                <rate_type>flat</rate_type>
                <free_shipping_subtotal>0</free_shipping_subtotal>
            </DOOR_dhlparcel>
            <PS_dhlparcel>
                <active>0</active>
                <title>Servicepoint</title>
                <rate_type>flat</rate_type>
                <free_shipping_subtotal>0</free_shipping_subtotal>
                <full_address_description>1</full_address_description>
            </PS_dhlparcel>
            <dhlparcel_time_windows>
                <enable>1</enable>
                <stock_only>0</stock_only>
                <shipment_days>1,2,3,4,5</shipment_days>
                <show_days_forward>14</show_days_forward>
                <transitdays>1</transitdays>
                <cutoff_time>10:00</cutoff_time>
                <sdd_cutoff_time>10:00</sdd_cutoff_time>
            </dhlparcel_time_windows>
            <dhlparcel_shipping_option_SDD>
                <active>0</active>
                <title>Same-day delivery</title>
                <price>5</price>
                <free_shipping_subtotal>0</free_shipping_subtotal>
            </dhlparcel_shipping_option_SDD>
            <dhlparcel_shipping_option_NBB>
                <active>0</active>
                <title>No neighbour delivery</title>
                <price>0.5</price>
                <free_shipping_subtotal>0</free_shipping_subtotal>
            </dhlparcel_shipping_option_NBB>
            <dhlparcel_shipping_option_EVE>
                <active>0</active>
                <title>Evening delivery</title>
                <price>0.5</price>
                <free_shipping_subtotal>0</free_shipping_subtotal>
            </dhlparcel_shipping_option_EVE>
            <dhlparcel_shipping_option_EXP>
                <active>0</active>
                <title>Expresses (delivery before 11:00)</title>
                <price>10</price>
                <free_shipping_subtotal>0</free_shipping_subtotal>
            </dhlparcel_shipping_option_EXP>
            <dhlparcel_shipping_option_BOUW>
                <active>0</active>
                <title>Delivery to construction site </title>
                <price>1</price>
                <free_shipping_subtotal>0</free_shipping_subtotal>
            </dhlparcel_shipping_option_BOUW>
            <dhlparcel_shipping_option_S>
                <active>0</active>
                <title>Saturday delivery</title>
                <price>1</price>
                <free_shipping_subtotal>0</free_shipping_subtotal>
            </dhlparcel_shipping_option_S>
            <dhlparcel_direct_print>
                <enable_download>1</enable_download>
            </dhlparcel_direct_print>
        </carriers>
    </default>
</config>
